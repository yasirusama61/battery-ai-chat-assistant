Cleaned text refin cnnbase heatmap regress gradientbas corner point electrod local lin wufiftywuoutlook.comabstract propos method detect electrod posit lithiumion batteri .. Process begin identifi region interest roi batteri xray imag corner point detect .. Convolut neural network use regress pole posit within roi .. Final , regress posit optim correct usecorner point prior , significantli mitig loss local accuraci caus oper featur mapdownsampl padnetwork train .. Find show combin tradit pixel gradient analysi cnnbase heatmap regress keypoint extract enhanc accuraci effici , result signific perform improv .. Keyword machin vision , heatmap regress , keypoint detect , electrod local 1. introduct qualiti batteri cell directli link precis local align electrod .. 1fold electrod sheet poor align four corner electrod assembl lithiumion batteri lead reduc perform , overh risk , mechan damag , safeti hazard .. Therefor , ensur accur align shape electrod sheet manufactur process crucial , particularli lithiumion batteri use highperform highsafeti applic , electr vehicl energi storag system .. Howev , duemultilevel structur cell signific overlap electrod sheet , xray imag often suffer lowbright , high nois , variat pole area size posit 2. challeng make accur electrod detect particularli difficult .. Exist autom detect algorithm fail fulli leverag uniqu featur x rayimag , lead high rate overkil .. End , propos novel joint optim framework incorpor gradientbas corner point detect method refin cnnbase heatmap regress electrod local .. Contribut summar follow preprint submit arxiv decemb 25 , 2024arxiv2412.17105v2 cs.cv24 dec2024the region interest roicorrespond pole area effici identifi high resolut xray imag usecorner point detect , , orient featur accel erat segment test ofast 3. highresolut neural network hrnet 4heatmap regress employ detect pole coordin , enhanc model adapt variou data augment tech niqu .. Confidencebas adjust modul introduc dynam refin pole detect result evalu confid pole predict hrnet refer corner detect ofast .. Variou evalu metric valid effect joint optim framework , combin cnnbase heatmap regress 5gradientbas corner point detec tion .. Addit , pcpercentag correct sampl introduc novel metric calcul proport sampl maximum normal error threshold .. 2. methodolog framework electrod local optim illustr fig .. 1a .. Given highresolut xray imag lithiumion batteri , initi employ corner point detect model extract set corner point .. Corner point subsequ input roiestim modul identifi smaller area focu .. Within roi , pole posit detect use cnnbase heatmap regress model .. Final , pole posit predict cnn model refin correct leverag corner point previous identifi gradientbas corner detect .. 2.1. corner point roidetect ofast improv tradit fast featur acceler segment test algorithm , aimenhanc rotat invari .. Core idea ofast detect corner point imag base local bright chang calcul direct corner point , algorithm still maintain good match result face rotat postur chang .. Duefact xray imag lithium batteri primarili grayscal imag , bright gradient featur pole posit rich , therefor use ofast extract corner point .. Shown fig .. 1b , detect corner point green primarili concentr pole region lithium batteri , although perfectli match actual pole posit .. Observ least actual pole posit must distinct bright gradient .. Phenomenon encourag umake full use distribut inform corner 2figur 1framework propos electrod local optim point .. Specif , letdetect setcorner point denot qq1 , q2 , ... , qn , qir2 , first calcul cluster center onecluster follow x0 , y01nnx i1qi 1 obtain center point , accumul rowwis grayscal valu xray imag form new pattern , shown fig .. 1b .. Pattern enabl ueasili identifi upper lower bound roi , correspond locat rowwis accumul gradient experi signific chang .. Setthreshold detect gradient chang , defin two pointer upper pointer move 0y0with step size b , lower pointer move imag height htoy0with step size a. process formal follow b 0nb , n0,1,2 , .. .. .. , hma , 0,1,2 , .. .. .. 2nandmar step indic , band aar step size upper lower pointer , respect .. Upper bound band lower bound , introduc new variabl control width roi , determin horizont coordin cluster center height roi .. Therefor achiev left bound cand right bound da follow cx0ba 3dx0ba 4scale factor adjust width roi base cluster center horizont posit height roi .. 32.2. electrod regress network roi , usekeypoint detect method estim pole imag .. Duesignific advantag hrnet highresolut featur extract precis keypoint local , wide adopt highaccuraci keypoint detect task .. Addit , hrnet util heatmap regress locat keypoint , enhanc model accuraci keypoint detect .. Therefor , choos hrnet electrod regress network .. Train , appli data augment techniqu rotat , reflect , affin transform .. Heatmap regress network train usemean squar error mseloss function .. Train set consist approxim 2,000sampl , test set contain around 1,000sampl .. 2.3. postcorrect corner point due comput effici hardwar deploy consider heatmap regressionbas 2d keypoint estim model , resolut featur maptypic lower origin input resolut .. Determin final keypoint coordin , featur map resolut upsampl match origin resolut .. Exampl , hrnet , featur map scale 14 input resolut .. Addit , oper multilay downsampl , upsampl , padinevit introduc discrep predict ground truth keypoint coordin .. Reduc discrep , propos postcorrect algorithm base corner point detect .. Specif , predict pole coordin pifrom regress network , radiu set , nearest corner point within circl radiu around pii select refer corner point qi , shown fig .. 1c .. Note corner point exist within radiu , point piwil refer corner .. Although captur pi , qipair , inevit nois error may still affect , caus neural network train local bright gradient pattern .. Therefor , need evalu confid two pole posit estim potenti fusion interact , shown fig .. 1d .. Evalu confid pi , qi , first need establish refer standard use assaffin piandqito standard .. Affin repres confid inform aimobtain .. Local featur extractor implement variou way , usebrief binari robust independ elementari featur 6 descriptor deep learningbas descriptor 7. , adopt effici approach given point xi , yi , defin small squar region center around , comput normal bright distribut histogram region local pattern .. Duepresenc posit neg termin lithium batteri , slight differ local pattern , usetwo color figur redposit termin .. 4address , design standard featur extractor summar local pattern posit negtermin input xray imag , calcul averag refer featur ri .. Similarli , usepatch featur extractor extract local featur ui , viforpiand qiindividu .. Thucorrespond confid , ican achiev follow ivi vi , riri , iuiui , riri 5confid captur measur uncertainti , natur aggreg pole estim pixi , yiandqix , i. xiixiix ii , yiiyiiy ii6 , xiand yiar refin pole coordin .. 3. experiment evalu 3.1. experiment set first appli ofast detect ncorner point .. Base , determin roi input hrnet .. Final , useconfidencebas coordin optim modul .. Provid baselin result base hrnet compar result differ choic n , correspond differ number corner point extract ofast .. 3.2. evalu metric adopt diver metric 8 compar differ experiment set includ nme , pck0.5 , pck1.0pcs0.5pcs1.0 .. Normal mean error nme useevalu accuraci predict keypoint com pare ground truth .. Calcul mean normal error across sampl keypoint , lower nme indic better perform .. Nmep spid , errdi refp spi17 d , erri error distanc predict true coordin keypoint iin sampl s.direfi refer distanc keypoint i. adopt diagon length roi refer distanc .. Pckpercentag correct keypoint calcul proport keypoint within accept error threshold , normal total number keypoint .. Often use evalu keypoint detect accuraci , higher pck indic better perform .. Pckp spid , errd refp spi18 5pcprcentag correct sampl calcul proport sampl maximum normal error among keypoint leequal threshold .. Higher pcsmax indic better perform , sampl maximum error within accept rang .. Pcsmax p smax id , errd refp s193.3 .. Numer result shown tabe .. 1 , experiment result demonstr addit corner point significantli improv keypoint local perform , especi number corner point increas .. Hrnet combin corner point particularli n 512consi tentli outperform baselin hrnet across evalu metric .. Improv indic corner point provid valuabl inform enhanc precis keypoint detect , particularli task requir high accuraci .. Tabl 1 perform comparison differ set .. Method nme pck0.5pck1.0pcs0.5pcs1.0hrnet baselin 0.6580.4210.8180.2390.965hrnet corner point n128 0.6240.4730.8360.3030.978hrnet corner point n256 0.6110.4860.8470.3370.978hrnet corner point n512 0.5820.5190.8650.3880.991rel gain 11.5523.285.7562.342.694. conclus paper , propos joint optim model integr cnnbase heatmap gression local gradientbas corner point detect .. Approach significantli improv local pole coordin xray imag lithium batteri .. Find suggest , keypoint extract task use deep learn , combin tradit pixel gradient analysi method cnnbase heatmap regress promis strategi .. Hybrid approach enhanc accuraci effici solut , lead notabl perform improv .. Acknowledg thank z.p.j .. Dr. h.d .. Discus project fengchao energi .. 6refer 1 a. dubaret delim e , t. lein , s. maletti , k. schmal , s. reuber , c. heubner , a. micha , impact electrod defect batteri cell perform review , batteri supercap 510 2022 e202200239 .. 2 .. Masuch , p. gumbel , n. kaden , k. droder , applic develop xray inspect techniqu batteri cell product , process 11 12022 10 .. 3e .. Ruble , v. rabaud , k. konolig , g. bradski , orbeffici altern sift surf , 2011 intern confer comput vision , ieee , 2011 , pp .. 25642571 .. 4k .. Sun , b. xiao , d. liu , j. wang , deep highresolut represent learn human pose estim , proceed ieeecvf confer comput vision pattern recognit , 2019 , pp .. 56935703 .. 5c .. Payer , d. stern , h. bischof , m. urschler , regress heatmap multipl landmark localiz usecnn , intern confer medic imag comput comput assist intervent , springer , 2016 , pp .. 230238 .. 6m .. Calond , v. lepetit , c. strecha , p. fua , brief binari robust independ elementari featur , comput visioneccv 2010 11th european confer comput vision , heraklion , crete , greec , septemb 511 , 2010 , proceed , part iv 11 , springer , 2010 , pp .. 778792 .. 7d .. Deton , t. malisiewicz , a. rabinovich , superpoint selfsupervis interest point detec tion descript , proceed ieee confer comput vision pattern recognit workshop , 2018 , pp .. 224236 .. 8b .. Yu , d. tao , heatmap regress viarandom round , ieee transact pattern analysi machin intellig 4411 2021 82768289 .. 7sections abstract we propose a method for detecting the electrode position inlithiumion battery .. Theprocess begin by identifying the region of interest roi inthe battery xray image through corner point detection .. Aconvolutional neural network isthen used to regress the pole position within this roi .. Finally , theregressed position are optimized and corrected using corner point prior , significantly mitigating theloss oflocalization accuracy caused byoperations such a feature map downsampling and padding during network training .. Ourfindings show that combining traditional pixel gradient analysis with cnnbased heatmap regression for keypoint extraction enhances both accuracy and efficiency , resulting in significant performance improvement .. Keywords machine vision , heatmap regression , keypoint detection , electrode localization 1. , introduction the quality of battery cell isdirectly linked to theprecise localization and alignment of theelectrodes .. 1the folding of theelectrode sheet or poor alignment ofthe four corner ofthe electrode assembly inlithiumion battery can lead to reduced performance , overheating risk , mechanical damage , andsafety hazard .. Therefore , ensuring the accurate alignment andshape ofthe electrode sheet during the manufacturing process iscrucial , particularly for lithiumion battery used in highperformance and highsafety application , such a electric vehicle andenergy storage system .. However , dueto themultilevels structure of thecells andthe significant overlap between the electrode sheet , xray image often suffer from low brightness , high noise , andvariations inpole area size andpositions 2. these challenge make accurate electrode detection particularly difficult .. Existing automated detection algorithm fail to fully leverage theunique feature of xray image , leading to ahigh rate of overkill .. Tothis end , wepropose anovel joint optimization framework that incorporates a gradientbased corner point detection method to refine cnnbased heatmap regression forelectrode localization .. Ourcontributions aresummarized asfollows preprint submitted toarxiv december 25 , 2024arxiv2412.17105v2 cs.cv24 dec2024the region of interest roi corresponding to thepole area is efficiently identified inhigh resolution xray image using corner point detection , that is , oriented feature from accel erated segment test ofast 3. ahighresolution neural network hrnet 4 with heatmap regression is employed to detect pole coordinate , enhancing model adaptability through various data augmentation tech niques .. Aconfidencebased adjustment module isintroduced todynamically refine pole detection result byevaluating theconfidence ofthe pole predicted byhrnet andtheir reference corner detected by ofast .. Various evaluation metric validate theeffectiveness ofour joint optimization framework , which combine cnnbased heatmap regression 5 andgradientbased corner point detec tion .. Additionally , pcspercentage ofcorrect sample is introduced a anovel metric to calculate the proportion of sample with maximum normalized error below athreshold .. 2. methodology our framework for electrode localization andoptimization isillustrated inthe fig .. 1a .. Given highresolution xray image ofthe lithiumion battery , weinitially employ a corner point detection model toextract aset ofcorner point .. These corner point are subsequently input into an roiestimation module to identify a smaller area forfurther focus .. Within this roi , pole position aredetected using a cnnbased heatmap regression model .. Finally , thepole position predicted bythe cnnmodel arerefined andcorrected byleveraging thecorner point previously identified through gradientbased corner detection .. 2.1. corner point androi detection ofast isan improvement on thetraditional fast feature from accelerated segment test algorithm , aiming to enhance it rotation invariance .. Thecore idea of ofast is todetect corner point inan image based onlocal brightness change andcalculate thedirection ofeach corner point , sothat thealgorithm canstill maintain good matching result when facing rotation or posture change .. Dueto thefact that xray image of lithium battery areprimarily grayscale image , andthe brightness gradient feature at thepole position are very rich , wetherefore useofast toextract corner point .. Asshown infig .. 1b , these detected corner point ingreen areprimarily concentrated in thepole region of thelithium battery , although they donot perfectly match theactual pole position .. Itcan beobserved that at least the actual pole position must have distinct brightness gradient .. This phenomenon encourages u tomake full use ofthe distribution information ofthese corner 2figure 1framework ofthe proposed electrode localization and optimization point .. Specifically , letthe detected set ofcorner point be denoted a qq1 , q2 , ... , qn , qir2 , wefirst calculate their cluster center only one cluster a follows x0 , y01nnx i1qi 1 after obtaining thecenter point , weaccumulate therowwise grayscale value ofthe xray image toform anew pattern , asshown infig .. 1b .. This pattern enables u toeasily identify the upper and lower bound ofthe roi , which correspond tothe location where therowwise accumulated gradient experience a significant change .. Weset athreshold todetect these gradient change , anddefine twopointers theupper pointer move from 0 toy0with astep size b , while the lower pointer move from theimage height htoy0with astep size a. this process canbe formalized a follows b 0nb , n0,1,2 , .. .. .. , ahma , m0,1,2 , .. .. .. 2where nandmare the step index , andband aare the step size forthe upper and lower pointer , respectively .. Once we have the upper bound band the lower bound a , weintroduce anew variable to control the width of theroi , which is determined by thehorizontal coordinate of thecluster center and theheight ofthe roi .. Wetherefore achieve the left bound cand right bound da follows cx0ba 3dx0ba 4where isa scaling factor that adjusts thewidth ofthe roibased onthe cluster center horizontal position andthe height of theroi .. 32.2. electrode regression network once wehave theroi , wecan useany keypoint detection method to estimate the pole in theimage .. Dueto thesignificant advantage of hrnet in highresolution feature extraction and precise keypoint localization , ithas been widely adopted for highaccuracy keypoint detection task .. Additionally , hrnet utilizes heatmap regression tolocate keypoints , which enhances themodels accuracy in keypoint detection .. Therefore , wechoose hrnet a ourelectrode regression network .. During training , weapplied data augmentation technique such asrotation , reflection , andother affine transformation .. Theheatmap regression network istrained using mean squared error mseas theloss function .. Thetraining setconsists ofapproximately 2,000samples , while the test set contains around 1,000samples .. 2.3. postcorrection with corner point dueto thecomputational efficiency and hardware deployment consideration of heatmap regressionbased 2dkeypoint estimation model , theresolution ofthe feature map istypically lower than theoriginal input resolution .. When determining thefinal keypoint coordinate , thefeature mapresolution isupsampled tomatch theoriginal resolution .. Forexample , inhrnet , thefeature mapscale is14 ofthe input resolution .. Additionally , operation such asmultilayer downsampling , upsampling , andpadding inevitably introduce some discrepancy between the predicted andground truth keypoint coordinate .. Tofurther reduce this discrepancy , wepropose apostcorrection algorithm based oncorner point detection .. Specifically , foreach predicted pole coordinate pifrom theregression network , theradius isset , andthe nearest corner point within thecircle ofradius around piis selected a thereference corner point qi , asshown infig .. 1c .. Note that ifno corner point exist within theradius , thepoint piwill not have a reference corner .. Although we have captured thepi , qipairs , inevitable noise orerrors maystill affect them , which is caused by neural network training and local brightness gradient pattern .. Therefore , weneed toevaluate theconfidence ofthe twopole position estimate before a potential fusion andinteraction , asshown infig .. 1d .. Before evaluating theconfidence ofpi , qi , wefirst need to establish a reference standard which will beused toassess theaffinity ofpiandqito this standard .. This affinity represents the confidence information weaim toobtain .. Ourlocal feature extractor canbe implemented in various way , such a using brief binary robust independent elementary feature 6 descriptor or other deep learningbased descriptor 7. here , weadopt amore efficient approach forum given point xi , yi , wedefine asmall square region centered around it , andcompute thenormalized brightness distribution histogram of this region asits local pattern .. Dueto thepresence ofboth positive and negative terminal inlithium battery , with slight difference in their local pattern , weuse twocolors inthe figure red forthe positive terminal .. To4address this , wedesign astandard feature extractor that summarizes thelocal pattern of both the positive and negative terminal inan input xray image , calculating their average a thereference feature ri .. Similarly , weuse apatch feature extractor toextract thelocal feature ui , viforpiand qiindividually .. Thus the corresponding confidence i , ican be achieved a follows ivi vi , riri , iuiui , riri 5once theconfidence foreach iscaptured asa measure of uncertainty , wenaturally aggregate the pole estimate from both thepixi , yiandqix i , yi .. Xiixiix i ii , yiiyiiy i ii6where , xiand yiare therefined pole coordinate .. 3. experimental evaluation 3.1. experimental setting wefirst apply ofast todetect ncorner point .. Based on this , wedetermine theroi andinput itinto hrnet .. Finally , weuse ourconfidencebased coordinate optimization module .. Weprovide baseline result based on hrnet and compare the result with different choice ofn , corresponding to different number ofcorner point extracted byofast .. 3.2. evaluation metric weadopt diverse metric 8to compare different experimental setting including nme , pck0.5 , pck1.0pcs0.5and pcs1.0 .. Normalized mean error nme isused toevaluate theaccuracy ofpredicted keypoints com pared to theground truth .. Itcalculates themean ofthe normalized error across all sample and keypoints , with a lower nme indicating better performance .. Nmep spids , ierrdi refp sp i17where d , ierris theerror distance between thepredicted andtrue coordinate for keypoint iin sample s.direfis thereference distance for keypoint i. here we adopt the diagonal length ofthe roias reference distance .. Pckpercentage ofcorrect keypoints calculates theproportion ofkeypoints that are within the acceptable error threshold , normalized by thetotal number of keypoints .. Itis often used toevaluate keypoint detection accuracy , with a higher pck indicating better performance .. Pckp spids , ierrds refp sp i185pcs prcentage of correct sample calculates the proportion of sample where themaximum normalized error among all keypoints is le than orequal tothe threshold .. Ahigher pcsmax indicates better performance , asmore sample have their maximum error within theacceptable range .. Pcsmax p smax id , ierrds refp s19 3.3. numerical result asshown intabe .. 1 , theexperimental result demonstrate that the addition of corner point significantly improves keypoint localization performance , especially when thenumber ofcorner point is increased .. Hrnet combined with corner point particularly with n 512consis tently outperforms thebaseline hrnet across allevaluation metric .. These improvement indicate that corner point provide valuable information that enhances the precision of keypoint detection , particularly for task requiring high accuracy .. Table 1 performance comparison ofdifferent setting .. Method nme pck0.5pck1.0pcs0.5pcs1.0hrnet baseline 0.6580.4210.8180.2390.965hrnet corner point n128 0.6240.4730.8360.3030.978hrnet corner point n256 0.6110.4860.8470.3370.978hrnet corner point n512 0.5820.5190.8650.3880.991relative gain 11.5523.285.7562.342.694. conclusion in this paper , wepropose ajoint optimization model that integrates cnnbased heatmap regression with local gradientbased corner point detection .. This approach significantly improves thelocalization ofpole coordinate in xray image oflithium battery .. Ourfindings suggest that , forkeypoint extraction task using deep learning , combining traditional pixel gradient analysis , reference 1 a. dubaret delim e , t. lein , s. maletti , k. schmal , s. reuber , c. heubner , a. michaelis , impact of electrode defect onbattery cell performance areview , battery supercaps 510 2022 e202200239 .. 2 .. Masuch , p. gumbel , n. kaden , k. droder , application and development of xray inspection technique in battery cell production , process 11 12022 10 .. 3e .. Rublee , v. rabaud , k. konolige , g. bradski , orban efficient alternative tosift orsurf , in2011 international conference oncomputer vision , ieee , 2011 , pp .. 25642571 .. 4k .. Sun , b. xiao , d. liu , j. wang , deep highresolution representation learning forhuman pose estimation , inproceedings ofthe ieeecvf conference oncomputer vision and pattern recognition , 2019 , pp .. 56935703 .. 5c .. Payer , d. stern , h. bischof , m. urschler , regressing heatmaps formultiple landmark lo calization using cnns , ininternational conference on medical image computing and computer assisted intervention , springer , 2016 , pp .. 230238 .. 6m .. Calonder , v. lepetit , c. strecha , p. fua , brief binary robust independent elementary feature , incomputer visioneccv 2010 11th european conference on computer vision , heraklion , crete , greece , september 511 , 2010 , proceeding , part iv 11 , springer , 2010 , pp .. 778792 .. 7d .. Detone , t. malisiewicz , a. rabinovich , superpoint selfsupervised interest point detec tion anddescription , inproceedings ofthe ieee conference oncomputer vision and pattern recognition workshop , 2018 , pp .. 224236 .. 8b .. Yu , d. tao , heatmap regression viarandomized rounding , ieee transaction onpattern analysis and machine intelligence 4411 2021 82768289 .. 7figures andtables figure figure 1 , table table 1keywords point , 36 , corner , 35 , detect , 26 , keypoint , 22 , local , 18 , pole , 18 , regress , 17 , featur , 16 , electrod , 15 , heatmap , 14